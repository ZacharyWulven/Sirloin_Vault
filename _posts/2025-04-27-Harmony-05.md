---
layout: post
title: 鸿蒙开发-05
date: 2025-04-25 16:45:30.000000000 +09:00
categories: [ArkTS]
tags: [ArkTS]
---


## 网络请求

### Step 1 声明所需的权限
* 开发者需要在 `entry/src/main/module.json5` 文件中声明所需权限


```
{
  "module": {
    "requestPermissions": [
      {
        "name": "ohos.permission.INTERNET" // add 网络访问权限
      }
    ],
  }
}
```

### Step 2 申请授权
* 如果目标权限的授权方式为 `system_grant` 开发者在完成 Step 1 后，系统会在安装应用时自动为其进行权限预授予，开发者不需要做其他操作即可使用权限
* 如果目标权限的授权方式为 `user_grant` 开发者在完成 Step 1 后，还需要再应用运行时弹框请求用户授权


> 由于网络访问权限的授权方式为 `system_grant`，因此只需完成第一步即可
{: .prompt-info }


### 安装 axios 库
* axios 库相当于鸿蒙一个第三方库，鸿蒙应用项目使用 ohpm 管理第三方库

```shell
$ ohpm i @ohos/axios
```


### 拦截器

```typescript
    const request = axios.create({
        baseURL: "http://localhost:8080",
        timeout: 2000
    })

    // 请求拦截器
    request.interceptors.request.use((config: InternalAxiosRequestConfig) => {
      console.info('will request')
      // 对请求数据做点什么
      return config
    }, (error: AxiosError) => {
      // 对请求错误做点什么
      return Promise.reject(error)
    })

    // 响应拦截器
    request.interceptors.response.use((response: AxiosResponse) => {
      console.info('will response')
      // 对响应数据做点什么
      return response
    }, (error: AxiosError) => {
      // 对响应错误做点什么
      return Promise.reject(error)
    })
```
